<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Unified Demo Pack — 3D Proof Map</title>
<style>
:root{color-scheme:dark}body{margin:0;overflow:hidden;background:#0b0f14;color:#e6eef7;font:13px/1.35 system-ui,sans-serif}
#ui{position:fixed;top:12px;left:12px;right:12px;display:flex;gap:10px;align-items:center;z-index:10}
.panel{background:rgba(15,23,33,.92);border:1px solid #1c2a3a;border-radius:10px;padding:10px 12px;backdrop-filter:blur(6px)}
.muted{color:#8b949e}#tip{position:fixed;pointer-events:none;z-index:20;padding:6px 10px;border-radius:8px;background:rgba(0,0,0,.8);border:1px solid rgba(255,255,255,.1);display:none}
#legend{position:fixed;left:12px;bottom:12px;font-size:11px}#legend div{display:flex;align-items:center;gap:6px;margin:3px 0}
.dot{width:10px;height:10px;border-radius:50%;display:inline-block}a{color:#58a6ff;text-decoration:none}a:hover{text-decoration:underline}
</style>
</head>
<body>
<div id="ui" class="panel"><a href="./index.html">← index</a><span class="muted" style="margin-left:10px">Drag: rotate · Wheel: zoom · Shift+drag: pan · Hover: details</span></div>
<div id="tip"></div><div id="legend" class="panel"></div>
<script src="./vendor/three.min.js"></script>
<script src="./unified_proofs_data.js"></script>
<script>
(function(){
const data=window.UNIFIED_PROOFS||{items:[],edges:[]},items=data.items||[],edges=data.edges||[];
const tip=document.getElementById('tip'),legend=document.getElementById('legend');
const colorMap={CLI:0x43a047,Crypto:0x1e88e5,FHE:0x8e24aa,ZK:0x9c27b0,Lattice:0xfb8c00,LoF:0xe53935,CryptoSheaf:0x00acc1,Quantum:0x00897b,UnifiedPack:0x7cb342,Contextuality:0xd81b60,Other:0x90a4ae};
const colorFor=f=>colorMap[f]||0x90a4ae;
const families=[...new Set(items.map(i=>i.family))].sort();
legend.innerHTML=families.map(f=>'<div><span class="dot" style="background:#'+colorFor(f).toString(16).padStart(6,'0')+'"></span>'+f+'</div>').join('');
const renderer=new THREE.WebGLRenderer({antialias:true});renderer.setPixelRatio(Math.min(2,devicePixelRatio||1));renderer.setSize(innerWidth,innerHeight);document.body.appendChild(renderer.domElement);
const scene=new THREE.Scene();scene.background=new THREE.Color(0x0b0f14);
const camera=new THREE.PerspectiveCamera(60,innerWidth/innerHeight,.01,200);
scene.add(new THREE.DirectionalLight(0xffffff,.9));scene.add(new THREE.AmbientLight(0xffffff,.35));
const pts=items.map(i=>i.pos3||{x:Math.random(),y:Math.random(),z:Math.random()});
let[mx,Mx,my,My,mz,Mz]=[1e9,-1e9,1e9,-1e9,1e9,-1e9];pts.forEach(p=>{mx=Math.min(mx,p.x);Mx=Math.max(Mx,p.x);my=Math.min(my,p.y);My=Math.max(My,p.y);mz=Math.min(mz,p.z);Mz=Math.max(Mz,p.z)});
const[cx,cy,cz]=[(mx+Mx)/2,(my+My)/2,(mz+Mz)/2],s=2/Math.max(1e-6,Mx-mx,My-my,Mz-mz);
const xyz=pts.map(p=>({x:(p.x-cx)*s,y:(p.y-cy)*s,z:(p.z-cz)*s}));
const geom=new THREE.SphereGeometry(.025,16,16),meshes=[];
items.forEach((it,i)=>{const mat=new THREE.MeshPhongMaterial({color:colorFor(it.family),shininess:30});const mesh=new THREE.Mesh(geom,mat);mesh.position.set(xyz[i].x,xyz[i].y,xyz[i].z);mesh.userData={idx:i};scene.add(mesh);meshes.push(mesh)});
const seg=new Float32Array(edges.length*6);let k=0;edges.forEach(([i,j])=>{const a=xyz[i],b=xyz[j];if(a&&b){seg[k++]=a.x;seg[k++]=a.y;seg[k++]=a.z;seg[k++]=b.x;seg[k++]=b.y;seg[k++]=b.z}});
const edgeGeom=new THREE.BufferGeometry();edgeGeom.setAttribute('position',new THREE.BufferAttribute(seg,3));scene.add(new THREE.LineSegments(edgeGeom,new THREE.LineBasicMaterial({color:0x3b4b5d,transparent:true,opacity:.4})));
const st={drag:false,pan:false,x0:0,y0:0,theta:.6,phi:1,r:3.2,tx:0,ty:0,tz:0},clamp=(x,a,b)=>Math.max(a,Math.min(b,x));
const updateCam=()=>{st.phi=clamp(st.phi,.05,Math.PI-.05);const sp=Math.sin(st.phi);camera.position.set(st.tx+st.r*sp*Math.cos(st.theta),st.ty+st.r*Math.cos(st.phi),st.tz+st.r*sp*Math.sin(st.theta));camera.lookAt(st.tx,st.ty,st.tz)};updateCam();
renderer.domElement.addEventListener('contextmenu',e=>e.preventDefault());
renderer.domElement.addEventListener('mousedown',e=>{st.drag=true;st.pan=e.shiftKey||e.button===2;st.x0=e.clientX;st.y0=e.clientY});
addEventListener('mouseup',()=>{st.drag=false;st.pan=false});
addEventListener('mousemove',e=>{if(!st.drag)return;const dx=e.clientX-st.x0,dy=e.clientY-st.y0;st.x0=e.clientX;st.y0=e.clientY;if(st.pan){const ps=.0025*st.r,dir=new THREE.Vector3();camera.getWorldDirection(dir);const rt=new THREE.Vector3().crossVectors(dir,camera.up).normalize(),up=camera.up.clone().normalize();st.tx-=rt.x*dx*ps;st.ty-=rt.y*dx*ps;st.tz-=rt.z*dx*ps;st.tx+=up.x*dy*ps;st.ty+=up.y*dy*ps;st.tz+=up.z*dy*ps}else{st.theta-=dx*.006;st.phi-=dy*.006}updateCam()});
renderer.domElement.addEventListener('wheel',e=>{e.preventDefault();st.r=clamp(st.r*(e.deltaY>0?1.08:.93),.5,40);updateCam()},{passive:false});
const ray=new THREE.Raycaster(),mouse=new THREE.Vector2();let hover=null;
renderer.domElement.addEventListener('mousemove',e=>{mouse.x=(e.clientX/innerWidth)*2-1;mouse.y=-(e.clientY/innerHeight)*2+1;ray.setFromCamera(mouse,camera);const hits=ray.intersectObjects(meshes);if(hits.length){const idx=hits[0].object.userData.idx;if(hover!==idx){hover=idx;tip.style.display='block';tip.style.left=(e.clientX+12)+'px';tip.style.top=(e.clientY+12)+'px';tip.innerHTML='<strong>'+items[idx].name+'</strong><br><span class="muted">'+items[idx].family+'</span>'}}else{hover=null;tip.style.display='none'}});
addEventListener('resize',()=>{camera.aspect=innerWidth/innerHeight;camera.updateProjectionMatrix();renderer.setSize(innerWidth,innerHeight)});
(function anim(){requestAnimationFrame(anim);renderer.render(scene,camera)})();
})();
</script>
</body>
</html>
